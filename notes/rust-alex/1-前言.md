# 前言

1. rust 的 5 道关卡

- 所有权机制
- 借用和生命周期
- 类型系统和 trait
- 突破抽象范式
- unsafe rust

## 学习方法

> 层次学习法或阶段学习法（刷墙式学习法）
> 知识是一层一层推进的

1. 万事皆有过程，过程也分阶段，**阶段即结构和层次**

2. rust 学习过程

- 自行看一遍 rust 语法（基层处理）
- 梳理语法
- 理解核心概念
- 知识是一层层推进的

### Rust 学习的建议

> 建立正确的 Rust 学习观

1. 从整体出发，不要让自己陷入到细节中去

> rust 中细节很多，陷进去很容易迷茫

学习需要掌控感，先从外围、从整体慢慢了解 Rust，如：

- Rust 语言有哪些特性？
- rust 设计哲学是什么？
- Rust 社区和生态如何？

可以对 rust 有一个高屋建瓴的结构性的认知，建立一个相应的知识网络，可以增加掌控感，并且可以促使信息进入到长时记忆，有效降低信息的损耗。

> 类比：画画，先画好轮廓，再画细节。

Rust 中关于细节的典型问题：字符串。它有很多种类型，如果对 rust 的整体设计没有任何概念，就会「很头痛」。**但是字符串背后都有一致性的规则，了解其背后的规则，字符串就变得非常简单。**

Rust 中语言特性很多，很难记住，其原因是没有从**整体结构**上把握 rust 语言，没有发现这些特性背后的「一致性规则」。

2. 抛弃一次性学会的念头，分层次递进式学习

> rust 语言中蕴含的知识体系本身就是有层次的。

Rust 的语言层次（架构）

[语言架构]

- 所有权系统
- 编程范式
- 类型系统
- 内存管理

[语言架构]

3. 和你已知的知识建立联系

> 这世界上没有任何一件事是凭空出现的，你不可能盖一座空中楼阁，知识也是一样的。

Rust 中有很多新的概念，它们都可以和旧的知识建立关联。新语言的出现，本质原因是为了解决某一个问题，如：Rust 中的所有权，它是解决问题的「一种手段」，如果要理解它，就需要明白问题是什么？即，理解什么是安全？为什么不安全？**安全和不安全是一体两面。** 搞明白了为什么不安全，就理解了 rust 解决不安全问题的思路，也就自然理解了所有权的概念。

**顺着知识的脉络去寻找，和已知的知识建立联系，这样才有助于构建知识网络。如果不能建立联系，那知识体系肯定存在漏洞，继续顺着知识的脉络去查漏补缺。**

类比：Rust 中为什么没有继承？

继承是实现代码复用的方法，但并非是完成这项工作的最佳工具。**Rust 采用的是组合的手段，** 相比于继承，组合面向接口设计，可以极大程度地降低父子系统具体实现的耦合。

类比：Rust 中不提供三元操作符，是因为 rust 语言里的条件控制是表达式，不是语句。

**Tips: 在和已知的知识建立联系的时候，应该更多地去关注 Rust 语言提供了什么样的解决问题的思路和方法，而不是批判 rust 语言没有某个特性，这样才能更好的理解 rust 语言。**

4. 学习阅读源码，从源码中学习

> rust 标准库的源码是非常值得读的。但需要通篇全读，只需要在学习的过程中，看到哪读到哪。

5. 通过主题式阅读填补知识空白。

6. 时刻把握 Rust 设计哲学

Rust:

- Fast
- safe
- concurrent

rust 中吸取了很多语言的特性，可以在 rust 中看到很多熟悉语言的影子，**但是要站在 rust 的角度去寻找共性，建立联系**，而不是站在熟悉的语言的角度上去看 rust。

7. 有意识地构建 rust 语言的心智模型

什么是「心智模型」呢？

可以说是「人脑」或你的思想和意识在客观世界的延伸，可以帮助你判断。

如何构建你的「心智模型」呢？

需要你从纷繁复杂的语言特性中，寻找共性，寻找一致性，在心智中建立起精简的知识网络。

8. 多分享多提问多交流

> Think - Pair - Share

**学习最忌讳的就是闭门造车。**

9. 为开源项目做贡献，锻炼自己。

10. 进阶《Rust 编程之道》

## 了解 Rust

### rust 从哪里来？

1. 一门语言的诞生，是为了解决一个问题。

历史：

- 2006 年，职业编程语言工程师，Graydon Hoare

Graydon Hoare 对 rust 语言的期望：

- 必须安全，不易崩溃
- 不需要引入 GC，注意性能
- 应该拥有广泛的特性，让程序员写出易于维护、调试、且更安全更高效的代码

- Rust 的设计哲学：
  - 内存安全为第一准则
  - 注重并发安全，避免数据竞争
  - 持续提升性能
  - 保持语言的高度一致性
  - 语言必须有可见的实用性
  - 注重开发体验和学习体验
  - 现代化语言特性
  - 拥抱开源社区

### rust 是什么？

Rust 是新时代的 C 语言，指的是 Rust 和 C 语言所处的历史地位是相似的。

#### 理由

1. Rust 语言是一门通用型语言

Rust 的通用性几乎和 C 一致，因为它拥抱了现代化的语言特性：

- rust 语言适合所有领域的绝大部分场景。裸机、操作系统、网络服务、上层应用等等
- 与其它语言横向比较，rust 拥有现代化语言特性，应用范围覆盖到 C/CPP/Java/Go/javascript 等语言领域

2. Rust 语言的内存安全方案针对的是 C 语言的不足

安全隐患包括：

- 静止对空指针和悬垂指针进行解引用
- 读取未初始化的内存
- 缓冲区溢出
- 非法释放已经释放或未分配的指针

3. 安全且无缝沟通 C 语言

- 通过 C-ABI 零成本和 C 语言打交道
- 划分了 Safe Rust 和 Unsafe Rust

unsafe rust 是 safe rust 的超集，在 unsafe rust 下，编译器依然会进行安全检查，但有 5 种情况例外：

- 解引用裸指针
- 调用 unsafe 函数和方法
- 访问或修改可变静态变量
- 实现 unsafe trait
- 读写 union 联合体中的字段

1. Rust 是具有混合范式的“面向过程”式的编程语言

- rust 包含了面向对象（OOP）、函数式（FP）和泛型三种编程范式
- OOP 和 FP 范式在 rust 中作为语言特性而存在的，并非抽象方式
- rust 让你专注于解决问题本身，而不受编程范式思想框架的干扰（**rust 设计哲学之一：实用性**）

5. 和 C 语言类似，担负时代的使命

> C 语言的发展史其实等价于操作系统和高级编程语言的发展史

- 操作系统遭遇发展瓶颈，rust 来拯救

docker 等容器化工具已经无法从根本上满足时代发展的需求，基于 rust 实现的新一代操作系统由此诞生

- 谷歌的 Fuchsia 用于构建物联网和 ai
- Amazon 使用 rust 基于 Linux 开发了可直接在裸机或虚拟机上运行容器的操作系统
- system76 使用纯 rust 开发了下一代安全的操作系统
- ...

- rust 是 WASI(WebAssembly System Interface)推广和普及的背后推手

- 基于 rust 实现的新语言如雨后春笋般冒出

### rust 要到哪里去？

rust 将为各个领域的基础设施建设做出贡献，未来也许会在多个领域出现杀手级应用。

### 要点

1. 未来的互联网世界，除了性能外，一定还会高度关注安全性。

2. Rust 在字形组合上，糅合了 Trust 和 Robust，暗示了信任与鲁棒性。Rust 的形状和自然界一种叫做锈菌的真菌相似，这种真菌生命力非常顽强。

3. rust 是追求安全、并发和性能三连击的语言，其语法特性都遵循这一目标。

4. rust 分为 safe rust 和 unsafe rust，safe rust 是构建于 unsafe rust 之上的。 **unsafe rust 不等于不安全，而是指编译器在 5 种特殊的操作时，把安全性交给开发者。**
